<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>To Do</title>
    <style type="text/css">
        @import "layout.css";
    </style>
    <script type="text/javascript" src="js/jquery.js"></script>
    <script type="text/javascript" src="js/easySlider1.5.js"></script>
    <script type="text/javascript">
        $(document).ready(function () {
            $("#slider").easySlider({
                auto: true,
                continuous: true
            });
        });
    </script>
    <style>
        body {
            background: rgb(156, 223, 216);
            font: Arial;
            text-align: center;
            color: #131414;
        }
    </style>
</head>

<body>
    <div id="centered">
        <div id="header">
            <a href="index-2.html"></a>
            <ul id="navigation">
                <li class="active"><a href="index-2.html">Home</a></li>
                <li><a href="capsLock.html">CapsLock</a></li>
                <li><a href="Toast.html">Toast</a></li>
                <li><a href="calculator.html">Calculator</a></li>
                <li><a href="SPS.html">StonePS</a></li>
                <li><a href="ToDo.html">ToDo</a></li>
                <li><a href="backgroundChanger.html">Backgroundchanger</a></li>
                <li><a href="stopwatch.html">Stopwatch</a></li>
            </ul>
        </div>
        <div id="banner">
            <div id="slider">
                <ul>
                    <li>
                        <img src="images/Untitled 4.jpg" alt="" />
                        <div class="info">
                            <div>
                                <h1>Javascript</h1>
                                <p></p>
                                <a href="#" class="more">More...</a>
                            </div>
                        </div>
                    </li>
                    <li>
                        <img src="images/Untitled 2.jpg" alt="" />
                        <div class="info">
                            <div>
                                <h1>Javascript Coding</h1>
                                <p></p>
                                <a href="#" class="more">More...</a>
                            </div>
                        </div>
                    </li>
                    <li>
                        <img src="images/Untitled 3.jpg" alt="" />
                        <div class="info">
                            <div>
                                <h1>Javascript Frameworks</h1>
                                <p></p>
                                <a href="#" class="more">More...</a>
                            </div>
                        </div>
                    </li>
                </ul>
            </div>
        </div>
    </div>
    <div class="container">
        <div class="row">
            <div class="col mx-auto col-md-8 mt-3 text-center">
                <div class="alert text-capitalize feedback">
                </div>
                <form id="itemForm" class="my-3">
                    <h3 class="text-capitalize mb-4">to do list</h3>
                    <div class="input-group">
                        <input type="text" class="form-control text-capitalize" id="itemInput" placeholder="name...">
                        <div class="input-group-append">
                            <button class="btn btn-green text-capitalize" type="submit">add item</button>
                        </div>
                    </div>
                </form>
                <div class="item-container">
                    <div class="item-list my-5">
                    </div>
                    <button type="button" class="btn btn-green my-3 text-capitalize" id="clear-list">clear
                        items</button>
                </div>
            </div>
        </div>
    </div>
    <script>
        const form = document.querySelector('#itemForm');
        const itemInput = document.querySelector('#itemInput');
        const itemList = document.querySelector('.item-list');
        const feedback = document.querySelector('.feedback');
        const clearButton = document.querySelector('#clear-list');

        let todoItems = [];

        const handleItem = function (itemName) {

            const items = itemList.querySelectorAll('.item');

            items.forEach(function (item) {

                if (item.querySelector('.item-name').textContent === itemName) {
                    item.querySelector('.complete-item').addEventListener('click', function () {
                        item.querySelector('.item-name').classList.toggle('completed');
                        this.classList.toggle('visibility');
                    });
                    item.querySelector('.edit-item').addEventListener('click', function () {
                        itemInput.value = itemName;
                        itemList.removeChild(item);

                        todoItems = todoItems.filter(function (item) {
                            return item !== itemName;
                        });
                    });
                    item.querySelector('.delete-item').addEventListener('click', function () {
                        debugger;
                        itemList.removeChild(item);

                        todoItems = todoItems.filter(function (item) {
                            return item !== itemName;
                        });

                        showFeedback('item delete', 'success');
                    })
                }
            })
        }

        const removeItem = function (item) {
            console.log(item);
            const removeIndex = (todoItems.indexOf(item));
            console.log(removeIndex);
            todoItems.splice(removeIndex, 1);
        }

        const getList = function (todoItems) {
            itemList.innerHTML = '';

            todoItems.forEach(function (item) {
                itemList.insertAdjacentHTML('beforeend',
                    `<div class="item my-3"><h5 class="item-name text-capitalize">${item}</h5><div class="item-icons"><a href="#" class="complete-item mx-2 item-icon"><i class="far fa-check-circle"></i></a><a href="#" class="edit-item mx-2 item-icon"><i class="far fa-edit"></i></a><a href="#" class="delete-item item-icon"><i class="far fa-times-circle"></i></a></div></div>`
                );

                handleItem(item);
            });
        }

        const getLocalStorage = function () {

            const todoStorage = localStorage.getItem('todoItems');
            if (todoStorage === 'undefined' || todoStorage === null) {
                todoItems = [];
            } else {
                todoItems = JSON.parse(todoStorage);
                getList(todoItems);
            }
        }

        const setLocalStorage = function (todoItems) {
            localStorage.setItem('todoItems', JSON.stringify(todoItems));
        }

        getLocalStorage();


        form.addEventListener('submit', function (e) {
            e.preventDefault();
            const itemName = itemInput.value;

            if (itemName.length === 0) {
                feedback.innerHTML = 'Please Enter Valid Value';
                feedback.classList.add('showItem', 'alert-danger');
                setTimeout(
                    function () {
                        feedback.classList.remove('showItem');
                    }, 3000);
            } else {
                todoItems.push(itemName);
                setLocalStorage(todoItems);
                getList(todoItems);
            }

            itemInput.value = '';

        });

        clearButton.addEventListener('click', function () {
            todoItems = [];
            localStorage.clear();
            getList(todoItems);
        })
    </script>
      <div id="footer">

        <span class="copyright"> 2020 <a href="#">Bazargurev.mn</a>. All rights reserved.</span>
    </div>
    </div>
</body>

</html>